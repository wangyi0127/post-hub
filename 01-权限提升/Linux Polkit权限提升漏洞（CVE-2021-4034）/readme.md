# 0x01-先决条件
```
经测试，非sudo组的普通用户即可
```

# 0x02-影响版本
```
CentOS系列：
CentOS 6：polkit-0.96-11.el6_10.2
CentOS 7：polkit-0.112-26.el7_9.1
CentOS 8.0：polkit-0.115-13.el8_5.1
CentOS 8.2：polkit-0.115-11.el8_2.2
CentOS 8.4：polkit-0.115-11.el8_4.2
​
Ubuntu系列：
Ubuntu 20.04 LTS：policykit-1 - 0.105-26ubuntu1.2
Ubuntu 18.04 LTS：policykit-1 - 0.105-20ubuntu0.18.04.6
Ubuntu 16.04 ESM：policykit-1 - 0.105-14.1ubuntu0.5+esm1
Ubuntu 14.04 ESM：policykit-1 - 0.105-4ubuntu3.14.04.6+esm1

CentOS下查看polkit版本可执行：rpm -qa|grep "polkit"
```

# 0x03-复现背景
```
uname
Linux bogon 3.10.0-957.el7.x86_64 #1 SMP Thu Nov 8 23:39:32 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux

cat /etc/redhat-release
CentOS Linux release 7.6.1810 (Core)
```

# 0x04-复现过程
```
ls -alh /root/
提示权限禁止

查看polkit版本在受影响范围内

从github下载shell脚本执行没有反应（可能是GFW的问题），改为从自己vps下载，成功拿到rootshell，如下图
```
![image](./pic/01.png)

参考连接：  
https://www.adminxe.com/3216.html  
https://www.4hou.com/posts/AKL9  
https://github.com/berdav/CVE-2021-4034  
https://twitter.com/search?q=pwnkit&src=typed_query&f=top  